(function(n,t){"use strict";function f(){if("pageYOffset"in n)return{scrollTop:pageYOffset,scrollLeft:pageXOffset};var t,i,r=document,u=r.documentElement,f=r.body;return t=u.scrollLeft||f.scrollLeft||0,i=u.scrollTop||f.scrollTop||0,{scrollTop:i,scrollLeft:t}}function r(t,i){return t===n?i==="clientWidth"?n.innerWidth:n.innerHeight:t[i]}function o(t,i){return t===n?f()[i]:t[i]}function s(t,i,r){var u=t.getBoundingClientRect()[r?"left":"top"],e=i===n?0:i.getBoundingClientRect()[r?"left":"top"];return u-e+(i===n?f():i)[r?"scrollLeft":"scrollTop"]}var i=document.documentElement,u=i.matches?"matches":i.matchesSelector?"matchesSelector":i.webkitMatches?"webkitMatches":i.webkitMatchesSelector?"webkitMatchesSelector":i.msMatches?"msMatches":i.msMatchesSelector?"msMatchesSelector":i.mozMatches?"mozMatches":i.mozMatchesSelector?"mozMatchesSelector":null,e=t.element.prototype.closest||function(n){for(var i=this[0].parentNode;i!==document.documentElement&&i!=null&&!i[u](n);)i=i.parentNode;return i&&i[u](n)?t.element(i):t.element()},h=t.module("vs-repeat",[]).directive("vsRepeat",["$compile","$parse",function(i,u){return{restrict:"A",scope:!0,compile:function(f,h){var p=t.isDefined(h.vsRepeatContainer)?t.element(f[0].querySelector(h.vsRepeatContainer)):f,c=p.children().eq(0),a,nt=c[0].outerHTML,w,k,tt,d,l,v="$vs_collection",b=!1,it={vsRepeat:"elementSize",vsOffsetBefore:"offsetBefore",vsOffsetAfter:"offsetAfter",vsScrolledToEndOffset:"scrolledToEndOffset",vsExcess:"excess"},g,y;if(c.attr("ng-repeat"))l="ng-repeat",a=c.attr("ng-repeat");else if(c.attr("data-ng-repeat"))l="data-ng-repeat",a=c.attr("data-ng-repeat");else if(c.attr("ng-repeat-start"))b=!0,l="ng-repeat-start",a=c.attr("ng-repeat-start");else if(c.attr("data-ng-repeat-start"))b=!0,l="data-ng-repeat-start",a=c.attr("data-ng-repeat-start");else throw new Error("angular-vs-repeat: no ng-repeat directive on a child element");if(w=/^\s*(\S+)\s+in\s+([\S\s]+?)(track\s+by\s+\S+)?$/.exec(a),k=w[1],tt=w[2],d=w[3],b)for(g=0,y=p.children().eq(0);y.attr("ng-repeat-end")==null&&y.attr("data-ng-repeat-end")==null;)g++,y=p.children().eq(g),nt+=y[0].outerHTML;return p.empty(),{pre:function(f,h,c){function gt(){if(!y||y.length<1)f[v]=[],p=0,f.sizesCumulative=[0];else if(p=y.length,ct){f.sizes=y.map(function(n){var i=f.$new(!1),r;return t.extend(i,n),i[k]=n,r=c.vsSize||c.vsSizeProperty?i.$eval(c.vsSize||c.vsSizeProperty):f.elementSize,i.$destroy(),r});var n=0;f.sizesCumulative=f.sizes.map(function(t){var i=n;return n+=t,i});f.sizesCumulative.push(n)}else vt();wt()}function vt(){at&&f.$$postDigest(function(){var u;if(a[0].offsetHeight||a[0].offsetWidth){for(var t=a.children(),n=0,i=!1,r=!1;n<t.length;){if(t[n].attributes[l]!=null||r)if(i||(f.elementSize=0),i=!0,t[n][dt]&&(f.elementSize+=t[n][dt]),b)if(t[n].attributes["ng-repeat-end"]!=null||t[n].attributes["data-ng-repeat-end"]!=null)break;else r=!0;else break;n++}i&&(wt(),at=!1,f.$root&&!f.$root.$$phase&&f.$apply())}else u=f.$watch(function(){(a[0].offsetHeight||a[0].offsetWidth)&&(u(),vt())})})}function yt(){var n=ot==="tr"?"":"min-";return ft?n+"width":n+"height"}function ni(){kt()&&f.$digest()}function ti(){typeof c.vsAutoresize!="undefined"&&(at=!0,vt(),f.$root&&!f.$root.$$phase&&f.$apply());kt()&&f.$apply()}function wt(){rt=void 0;g=void 0;pt=p;ut=0;fi(ct?f.sizesCumulative[p]:f.elementSize*p);kt();f.$emit("vsRepeatReinitialized",f.startIndex,f.endIndex)}function fi(n){f.totalSize=f.offsetBefore+n+f.offsetAfter}function ri(){var n=r(w[0],bt);n!==ii&&(wt(),f.$root&&!f.$root.$$phase&&f.$apply());ii=n}function kt(){var e=o(w[0],ui),b=r(w[0],bt),h=a[0]===w[0]?0:s(a[0],w[0],ft),n=f.startIndex,i=f.endIndex,t,l;if(ct){for(n=0;f.sizesCumulative[n]<e-f.offsetBefore-h;)n++;for(n>0&&n--,n=Math.max(Math.floor(n-f.excess/2),0),i=n;f.sizesCumulative[i]<e-f.offsetBefore-h+b;)i++;i=Math.min(Math.ceil(i+f.excess/2),p)}else n=Math.max(Math.floor((e-f.offsetBefore-h)/f.elementSize)-f.excess/2,0),i=Math.min(n+Math.ceil(b/f.elementSize)+f.excess,p);if(pt=Math.min(n,pt),ut=Math.max(i,ut),f.startIndex=lt.latch?pt:n,f.endIndex=lt.latch?ut:i,t=!1,rt==null?t=!0:g==null&&(t=!0),t||(lt.hunked?Math.abs(f.startIndex-rt)>=f.excess/2||f.startIndex===0&&rt!==0?t=!0:(Math.abs(f.endIndex-g)>=f.excess/2||f.endIndex===p&&g!==p)&&(t=!0):t=f.startIndex!==rt||f.endIndex!==g),t){f[v]=y.slice(f.startIndex,f.endIndex);f.$emit("vsRepeatInnerCollectionUpdated",f.startIndex,f.endIndex,rt,g);c.vsScrolledToEnd&&(l=y.length-(f.scrolledToEndOffset||0),(f.endIndex>=l&&g<l||y.length&&f.endIndex===y.length)&&f.$eval(c.vsScrolledToEnd));rt=f.startIndex;g=f.endIndex;var d=ct?"(sizesCumulative[$index + startIndex] + offsetBefore)":"(($index + startIndex) * elementSize + offsetBefore)",k=u(d),nt=k(f,{$index:0}),tt=k(f,{$index:f[v].length}),it=f.totalSize;st.css(yt(),nt+"px");ht.css(yt(),it-tt+"px")}return t}var a=t.isDefined(c.vsRepeatContainer)?t.element(h[0].querySelector(c.vsRepeatContainer)):h,et=t.element(nt),ot=et[0].tagName.toLowerCase(),y=[],p,ft=typeof c.vsHorizontal!="undefined",st=t.element("<"+ot+' class="vs-repeat-before-content"><\/'+ot+">"),ht=t.element("<"+ot+' class="vs-repeat-after-content"><\/'+ot+">"),at=!c.vsRepeat,ct=!!c.vsSize||!!c.vsSizeProperty,w=c.vsScrollParent?c.vsScrollParent==="window"?t.element(n):e.call(a,c.vsScrollParent):a,lt="vsOptions"in c?f.$eval(c.vsOptions):{},bt=ft?"clientWidth":"clientHeight",dt=ft?"offsetWidth":"offsetHeight",ui=ft?"scrollLeft":"scrollTop",rt,g,pt,ut,ii;if(f.totalSize=0,!("vsSize"in c)&&"vsSizeProperty"in c&&console.warn("vs-size-property attribute is deprecated. Please use vs-size attribute which also accepts angular expressions."),w.length===0)throw"Specified scroll parent selector did not match any element";f.$scrollParent=w;ct&&(f.sizesCumulative=[]);f.elementSize=+c.vsRepeat||r(w[0],bt)||50;f.offsetBefore=0;f.offsetAfter=0;f.excess=2;ft?(st.css("height","100%"),ht.css("height","100%")):(st.css("width","100%"),ht.css("width","100%"));Object.keys(it).forEach(function(n){c[n]&&c.$observe(n,function(t){f[it[n]]=+t;wt()})});f.$watchCollection(tt,function(n){y=n||[];gt()});et.eq(0).attr(l,k+" in "+v+(d?" "+d:""));et.addClass("vs-repeat-repeated-element");a.append(st);a.append(et);i(et)(f);a.append(ht);f.startIndex=0;f.endIndex=0;w.on("scroll",ni);t.element(n).on("resize",ti);f.$on("$destroy",function(){t.element(n).off("resize",ti);w.off("scroll",ni)});f.$on("vsRepeatTrigger",gt);f.$on("vsRepeatResize",function(){at=!0;vt()});f.$on("vsRenderAll",function(){lt.latch&&setTimeout(function(){var n=p;ut=Math.max(n,ut);f.endIndex=lt.latch?ut:n;f[v]=y.slice(f.startIndex,f.endIndex);g=f.endIndex;f.$$postDigest(function(){st.css(yt(),0);ht.css(yt(),0)});f.$apply(function(){f.$emit("vsRenderAllDone")})})});f.$watch(function(){typeof n.requestAnimationFrame=="function"?n.requestAnimationFrame(ri):ri()})}}}}}]);typeof module!="undefined"&&module.exports&&(module.exports=h.name)})(window,window.angular);
//# sourceMappingURL=angular-vs-repeat.min.js.map
